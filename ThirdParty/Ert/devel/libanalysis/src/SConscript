import os
import os.path
import sys
sys.path += ["../../scons-config"]
import global_config
from   global_config import LIBUTIL
from   global_config import LIBANALYSIS
from   global_config import add_static_library
from   global_config import add_shared_library
from   global_config import add_header
from   global_config import get_target
from   global_config import add_program

package      = "analysis"
lib_path     = "../lib"
slib_path    = "../lib"
include_path = "../include"
module_path  = "../modules"


conf = global_config.get_conf(os.getcwd() , 2)
env  = Environment()
conf.update_env( env , [ LIBUTIL , LIBANALYSIS ] , link = False)

src_list = Split("analysis_module.c enkf_linalg.c")
src_list.append("std_enkf.c")
src_list.append("sqrt_enkf.c")
src_list.append("cv_enkf.c")
src_list.append("bootstrap_enkf.c")
src_list.append("null_enkf.c")
src_list.append("fwd_step_enkf.c")

header_list = Split("analysis_module.h analysis_table.h enkf_linalg.h")

add_shared_library( env , conf , slib_path , package , src_list)
add_header( env , conf , include_path , header_list )

env['SHLIBPREFIX'] = ""
add_shared_library( env , conf , module_path , "std_enkf.so" , ["std_enkf.c"] )
add_shared_library( env , conf , module_path , "sqrt_enkf.so" , ["sqrt_enkf.c"] )
add_shared_library( env , conf , module_path , "cv_enkf.so" , ["cv_enkf.c"] )
add_shared_library( env , conf , module_path , "bootstrap_enkf.so" , ["bootstrap_enkf.c"] )
add_shared_library( env , conf , module_path , "null_enkf.so" , ["null_enkf.c"] )
add_shared_library( env , conf , module_path , "fwd_step_enkf.so" , ["fwd_step_enkf.c"] )


Default( include_path , slib_path , module_path )

